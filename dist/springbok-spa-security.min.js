!function(){"use-strict";var e=["ngCookies","springbok.core"],t=angular.module("springbok.security",e);t.run(["endpoints",function(e){e.add("accounts","accounts"),e.add("currentAccount","accounts/authenticated"),e.add("credentials","credentials")}])}(),function(){"use strict";function e(e,t,n,i,r){var o=this;o.session=n,this.login=function(){r.login().then(function(){e.$emit("Notify","success","SECURITY_LOGIN_SUCCESS"),e.$emit("AuthenticationChange"),_.isNull(i.url)||(t.path(i.url),i.url=null)},function(t){"wrongCredentials"===t.reason?e.$emit("Notify","error","SECURITY_LOGIN_INVALID"):e.$emit("Notify","error","ERROR_SERVER"),e.$emit("AuthenticationChange")})},this.logout=function(){r.logout(),e.$emit("Notify","warning","SECURITY_LOGIN_LOGOUT"),e.$emit("AuthenticationChange"),t.path("/")}}angular.module("springbok.security").controller("authenticationController",e),e.$inject=["$scope","$location","session","authenticationRedirect","authenticationService"]}(),function(){"use strict";angular.module("springbok.security").value("authenticationRedirect",{url:null})}(),function(){"use strict";function e(e,t,n,i,r,o){var a=this;a.logout=function(){delete t.defaults.headers.common.Authorization,r.clean(),o.clear(),n.clear()},a.login=function(){var o=e.defer();return n.setTokenAndExpiration(),t.get(i.get("currentAccount")).then(function(e){200===e.status&&(n.update(e.data),r.getCredentialsForUsername(n.account.username),o.resolve(e.infos))},function(e){a.logout(),403===e.status||401===e.status?o.reject({reason:"wrongCredentials"}):o.reject({reason:"serverError"})}),o.promise}}angular.module("springbok.security").service("authenticationService",e),e.$inject=["$q","$http","session","endpoints","credentialService","searchCriterias"]}(),function(){"use strict";function e(e,t,n){var i,r=[];return{all:function(){var i=n.defer(),r={params:{size:1e3,direction:"asc",properties:"label"}};return t.get(e.get("credentials")+"/search",r).then(function(e){i.resolve(e.data.content)}),i.promise},getCredentialsForUsername:function(o){if(!_.isUndefined(r)&&r.length>0&&!_.isUndefined(i))return i;var a=n.defer(),c={params:{size:1e3,direction:"asc",properties:"label",username:o}};return t.get(e.get("credentials")+"/search",c).then(function(e){r=e.data.content,a.resolve(r)}),a.promise},hasCredential:function(e){var t=_.filter(r,function(t){return t.code===e});return t.length>0},setCredentials:function(e){r=e},clean:function(){r=[],i=null}}}angular.module("springbok.security").service("credentialService",e),e.$inject=["endpoints","$http","$q"]}();