!function(){"use-strict";const t=["ngCookies","springbok.core"],e=angular.module("springbok.security",t);e.run(["endpoints",function(t){t.add("accounts","accounts"),t.add("currentAccount","accounts/authenticated"),t.add("credentials","credentials")}])}(),function(){"use strict";function t(t,e,n,r){var i=this;i.account=n.account,this.login=function(){n.login(this.account.username,this.account.password).then(function(){t.$emit("Notify","success","SECURITY_LOGIN_SUCCESS"),_.isNull(e.url)||(r.path(e.url),e.url=null)},function(e){console.log(e),"wrongCredentials"===e.reason?t.$emit("Notify","error","SECURITY_LOGIN_INVALID"):t.$emit("Notify","error","ERROR_SERVER")})},this.logout=function(){n.logout(),t.$emit("Notify","warning","SECURITY_LOGIN_LOGOUT"),e.url="/"}}angular.module("springbok.security").controller("authenticationController",t),t.$inject=["$scope","authenticationRedirect","authenticationService","$location"]}(),function(){"use strict";angular.module("springbok.security").value("authenticationRedirect",{url:null})}(),function(){"use strict";function t(t,e,n,r,i,o){function c(){s.account={infos:{},username:"",password:"",authenticated:!1}}function u(){var t="Basic ";return t+=n.encodeToBase64(s.account.username+":"+s.account.password)}var s=this;c(),s.logout=function(){c(),delete e.defaults.headers.common.Authorization,i.clean(),o.resetAllSearchCriterias()},s.login=function(){var n=t.defer();return e.defaults.headers.common.Authorization=u(),e.get(r.get("currentAccount")).then(function(t){200===t.status&&(s.account.infos=t.data,s.account.authenticated=!0,i.getCredentialsForUsername(s.account.username),n.resolve(t.infos))},function(t){s.logout(),403===t.status||401===t.status?n.reject({reason:"wrongCredentials"}):n.reject({reason:"serverError"})}),n.promise},s.getCurrentAccount=function(){return s.account.infos}}angular.module("springbok.security").service("authenticationService",t),t.$inject=["$q","$http","encryptionUtils","endpoints","credentialService","searchCriterias"]}(),function(){"use strict";function t(t,e,n){var r,i=[];return{getCredentialsForUsername:function(o){if(!_.isUndefined(i)&&i.length>0&&!_.isUndefined(r))return r;var c=n.defer(),u={params:{size:1e3,direction:"asc",properties:"label",username:o}};return e.get(t.get("credentials")+"/search",u).success(function(t){i=t.content,c.resolve(i)}),c.promise},hasCredential:function(t){var e=_.filter(i,function(e){return e.code===t});return e.length>0},setCredentials:function(t){i=t},clean:function(){i=[],r=null}}}angular.module("springbok.security").service("credentialService",t),t.$inject=["endpoints","$http","$q"]}();