!function(){"use-strict";const e=["ngCookies","springbok.core"],n=angular.module("springbok.security",e);n.run(["endpoints",function(e){e.add("accounts","accounts"),e.add("currentAccount","accounts/authenticated"),e.add("credentials","credentials")}])}(),function(){"use strict";function e(e,n,t,o){var c=this;c.account=t.account,this.login=function(){t.login().then(function(){console.log("success"),e.$emit("Notify","success","SECURITY_LOGIN_SUCCESS"),e.$emit("AuthenticationChange"),_.isNull(n.url)||(o.path(n.url),n.url=null)},function(n){console.log("error"),console.log(n),"wrongCredentials"===n.reason?e.$emit("Notify","error","SECURITY_LOGIN_INVALID"):e.$emit("Notify","error","ERROR_SERVER"),e.$emit("AuthenticationChange")})},this.logout=function(){t.logout(),c.account=t.account,e.$emit("Notify","warning","SECURITY_LOGIN_LOGOUT"),e.$emit("AuthenticationChange"),o.path("/")}}angular.module("springbok.security").controller("authenticationController",e),e.$inject=["$scope","authenticationRedirect","authenticationService","$location"]}(),function(){"use strict";angular.module("springbok.security").value("authenticationRedirect",{url:null})}(),function(){"use strict";function e(e,n,t,o,c,i){function r(){a.account={infos:{},username:"",password:"",authenticated:!1}}function u(){var e="Basic ";return e+=t.encodeToBase64(a.account.username+":"+a.account.password)}var a=this;a.account={},r(),a.logout=function(){r(),delete n.defaults.headers.common.Authorization,c.clean(),i.clear()},a.login=function(){var t=e.defer();return n.defaults.headers.common.Authorization=u(),n.get(o.get("currentAccount")).then(function(e){console.log("authenticationService.success"),console.log(e),200===e.status&&(a.account.infos=e.data,a.account.authenticated=!0,c.getCredentialsForUsername(a.account.username),t.resolve(e.infos))},function(e){console.log("authenticationService.error"),console.log(e),a.logout(),403===e.status||401===e.status?t.reject({reason:"wrongCredentials"}):t.reject({reason:"serverError"})}),t.promise},a.getCurrentAccount=function(){return a.account.infos}}angular.module("springbok.security").service("authenticationService",e),e.$inject=["$q","$http","encryptionUtils","endpoints","credentialService","searchCriterias"]}(),function(){"use strict";function e(e,n,t){var o,c=[];return{getCredentialsForUsername:function(i){if(!_.isUndefined(c)&&c.length>0&&!_.isUndefined(o))return o;var r=t.defer(),u={params:{size:1e3,direction:"asc",properties:"label",username:i}};return n.get(e.get("credentials")+"/search",u).success(function(e){c=e.content,r.resolve(c)}),r.promise},hasCredential:function(e){var n=_.filter(c,function(n){return n.code===e});return n.length>0},setCredentials:function(e){c=e},clean:function(){c=[],o=null}}}angular.module("springbok.security").service("credentialService",e),e.$inject=["endpoints","$http","$q"]}();