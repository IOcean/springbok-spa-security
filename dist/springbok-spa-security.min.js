!function(){"use-strict";const t=["ngCookies","springbok.core"],n=angular.module("springbok.security",t);n.run(["endpoints",function(t){t.add("accounts","accounts"),t.add("currentAccount","accounts/authenticated"),t.add("credentials","credentials")}])}(),function(){"use strict";function t(t,n,e,r){var i=this;i.account=e.account,this.login=function(){e.login().then(function(){t.$emit("Notify","success","SECURITY_LOGIN_SUCCESS"),_.isNull(n.url)||(r.path(n.url),n.url=null)},function(n){"wrongCredentials"===n.reason?t.$emit("Notify","error","SECURITY_LOGIN_INVALID"):t.$emit("Notify","error","ERROR_SERVER")})},this.logout=function(){e.logout(),t.$emit("Notify","warning","SECURITY_LOGIN_LOGOUT"),r.path("/")}}angular.module("springbok.security").controller("authenticationController",t),t.$inject=["$scope","authenticationRedirect","authenticationService","$location"]}(),function(){"use strict";angular.module("springbok.security").value("authenticationRedirect",{url:null})}(),function(){"use strict";function t(t,n,e,r,i,o){function c(){a.account={infos:{},username:"",password:"",authenticated:!1}}function u(){var t="Basic ";return t+=e.encodeToBase64(a.account.username+":"+a.account.password)}var a=this;c(),a.logout=function(){c(),delete n.defaults.headers.common.Authorization,i.clean(),o.clear()},a.login=function(){var e=t.defer();return n.defaults.headers.common.Authorization=u(),n.get(r.get("currentAccount")).then(function(t){200===t.status&&(a.account.infos=t.data,a.account.authenticated=!0,i.getCredentialsForUsername(a.account.username),e.resolve(t.infos))},function(t){a.logout(),403===t.status||401===t.status?e.reject({reason:"wrongCredentials"}):e.reject({reason:"serverError"})}),a.account.authenticated=!0,e.promise},a.getCurrentAccount=function(){return a.account.infos}}angular.module("springbok.security").service("authenticationService",t),t.$inject=["$q","$http","encryptionUtils","endpoints","credentialService","searchCriterias"]}(),function(){"use strict";function t(t,n,e){var r,i=[];return{getCredentialsForUsername:function(o){if(!_.isUndefined(i)&&i.length>0&&!_.isUndefined(r))return r;var c=e.defer(),u={params:{size:1e3,direction:"asc",properties:"label",username:o}};return n.get(t.get("credentials")+"/search",u).success(function(t){i=t.content,c.resolve(i)}),c.promise},hasCredential:function(t){var n=_.filter(i,function(n){return n.code===t});return n.length>0},setCredentials:function(t){i=t},clean:function(){i=[],r=null}}}angular.module("springbok.security").service("credentialService",t),t.$inject=["endpoints","$http","$q"]}();