!function(){"use-strict";const t=["ngCookies","springbok.core"],n=angular.module("springbok.security",t);n.run(["endpoints",function(t){t.add("accounts","accounts"),t.add("currentAccount","accounts/authenticated"),t.add("credentials","credentials")}])}(),function(){"use strict";function t(t,n,e){var r=this;r.account=n.account,this.login=function(){n.login(this.account.username,this.account.password).then(function(){_.isNull(t.url)||(e.path(t.url),t.url=null)})},this.logout=function(){n.logout(),t.url="/"}}angular.module("springbok.security").controller("authenticationController",t),t.$inject=["authenticationRedirect","authenticationService","$location"]}(),function(){"use strict";angular.module("springbok.security").value("authenticationRedirect",{url:null})}(),function(){"use strict";function t(t,n,e,r,o,i){function c(){a.account={infos:{},username:"",password:"",authenticated:!1}}function u(){var t="Basic ";return t+="YWRtaW46YWRtaW4="}var a=this;c(),a.logout=function(){c(),e.defaults.headers.common.Authorization="",localStorage.removeItem("auth"),o.clean(),i.resetAllSearchCriterias()},a.login=function(){var i=n.defer();return e.get(r.get("currentAccount")).then(function(n){200===n.status?(e.defaults.headers.common.Authorization=u(),a.account.infos=n.data,a.account.authenticated=!0,o.getCredentialsForUsername(a.account.username),i.resolve(n.infos)):403===n.status||401===n.status?(t.debug("Wrong username/password"),i.reject()):(t.error("An error occured during login"),a.logout(),i.reject())},function(){t.error("An error occured during login"),a.logout(),i.reject()}),i.promise},a.getCurrentAccount=function(){return a.account.infos}}angular.module("springbok.security").service("authenticationService",t),t.$inject=["$log","$q","$http","endpoints","credentialService","searchCriterias"]}(),function(){"use strict";function t(t,n,e){var r,o=[];return{getCredentialsForUsername:function(i){if(!_.isUndefined(o)&&o.length>0&&!_.isUndefined(r))return r;var c=e.defer(),u={params:{size:1e3,direction:"asc",properties:"label",username:i}};return n.get(t.get("credentialsSearch"),u).success(function(t){o=t.content,c.resolve(o)}),c.promise},hasCredential:function(t){var n=_.filter(o,function(n){return n.code===t});return n.length>0},setCredentials:function(t){o=t},clean:function(){o=[],r=null}}}angular.module("springbok.security").service("credentialService",t),t.$inject=["endpoints","$http","$q"]}();